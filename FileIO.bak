
// Compress and copy the file 
let compressAndCopyFile originalFileName targetFileName = 
    // TODO Check why the file size below 1.3 MB can't be compressed
    let minimumFileSize = int64 1300000
    let originalFileStream =  (FileInfo originalFileName).OpenRead() 
    let originalFileStreamLength = originalFileStream.Length
    if originalFileStreamLength > minimumFileSize then
        try 
            let targetFileStream = (FileInfo targetFileName).Create()
            let compressor = new Compression.DeflateStream(targetFileStream, Compression.CompressionLevel.Optimal)
            originalFileStream.CopyTo(compressor)
            printfn "%s (Size: %i) --- compressed to ---> %s (Size: %i)" originalFileName originalFileStreamLength targetFileName targetFileStream.Length
            targetFileStream.Close()
        with 
            ex -> 
                printfn "%s" ex.Message
    originalFileStream.Close() 

// DCeompress the file 
let decompressFile originalFileName targetFileName = 
    if File.Exists originalFileName then
        try
            let compressedFileStream = File.Open(originalFileName, FileMode.Open);
            let outputFileStream = File.Create(targetFileName);
            let decompressor = new Compression.DeflateStream(compressedFileStream, Compression.CompressionMode.Decompress);
            decompressor.CopyTo(outputFileStream);
            printfn "%s (Size: %i) --- decompressed to ---> %s (Size: %i)" originalFileName compressedFileStream.Length targetFileName outputFileStream.Length
            outputFileStream.Close()
            compressedFileStream.Close()
        with 
            ex -> 
                printfn "%s" ex.Message
    else
        printfn "Source File does not exist."